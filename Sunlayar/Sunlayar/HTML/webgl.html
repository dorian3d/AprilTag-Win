<!DOCTYPE html>
<!-- Copyright (c) 2015 Sunlayar. All rights reserved. -->
<html>
    <head>
        <style type="text/css">
            body {
                position:absolute;
                top:0px;
                left:0px;
                background-color: rgb(85,85,85);
                margin:0px 0px 0px 0px;
                padding:0px 0px 0px 0px;
                -webkit-touch-callout: none;
                -webkit-text-size-adjust: none;
                -webkit-user-select: none;
                -webkit-highlight: none;
                overflow: hidden;
            }
        
            html{
                overflow: hidden;
                height: 100%;
            }

            drawing {
                position:absolute;
                top:0px;
                left:0px;
                height:100%;
                width:100%;
                background-color: rgb(85,85,85);
                margin:0px 0px 0px 0px;
                padding:0px 0px 0px 0px;
                -webkit-touch-callout: none;
                -webkit-text-size-adjust: none;
                -webkit-user-select: none;
                -webkit-highlight: none;
                overflow: hidden;
            }

            canvas { width: 100%; height: 100% }

            #shutterButton { width: 50px; height: 40px; }
        
        </style>

        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=0">

        <script src="jquery-2.1.1.min.js"></script>
        <script src="three.min.js"></script>
        <script src="RC3DK.js"></script>
        <script src="RC3DKPlus.js"></script>

    </head>

    <body style="background-color: transparent;">
        <script>
            var scene = new THREE.Scene();
            var camera = new THREE.PerspectiveCamera( 75, window.innerWidth / window.innerHeight, 0.1, 1000 );
            var renderer = new THREE.WebGLRenderer();
            renderer.setSize( window.innerWidth, window.innerHeight );
            document.body.appendChild( renderer.domElement );

            var cube = new THREE.Mesh(
                    new THREE.CubeGeometry( 1, 1, 1 ),
                    new THREE.MeshLambertMaterial( { color: 0xFFFFFF } )
            );
            scene.add( cube );
            cube.position.z = -5;

            var light;

            // top
            light = new THREE.DirectionalLight( 0x0DEDDF );
            light.position.set( 0, 1, 0 );
            scene.add( light );

            // bottom
            light = new THREE.DirectionalLight( 0x0DEDDF );
            light.position.set( 0, -1, 0 );
            scene.add( light );

            // back
            light = new THREE.DirectionalLight( 0xB685F3 );
            light.position.set( 1, 0, 0 );
            scene.add( light );

            // front
            light = new THREE.DirectionalLight( 0xB685F3 );
            light.position.set( -1, 0, 0 );
            scene.add( light );

            // right
            light = new THREE.DirectionalLight( 0x89A7F5 );
            light.position.set( 0, 0, 1 );
            scene.add( light );

            // left
            light = new THREE.DirectionalLight( 0x89A7F5 );
            light.position.set( 0, 0, -1 );
            scene.add( light );

            RC3DK.setLicenseKey("aF9cE0B536c84aE6F500509E8aBCcC"); // Sunlayar license key
            RC3DK.hasCalibrationData(function (isCalibrated)
            {
                if (isCalibrated)
                {
                    RC3DK.showVideoView();
                    RC3DK.startSensors();
                    RC3DK.startSensorFusion();
                }
            });

            RC3DK.onStatusUpdate(function (status)
            {
                if (status.error)
                {
                    if (status.error.class == "RCSensorFusionError")
                    {
                        if (status.error.code > 1)
                        {
                            RC3DK.stopSensorFusion();
                            RC3DK.stopSensors();
                            alert(status.error.class + ":" + status.error.code);
                        }
                    }
                    else
                    {
                        RC3DK.stopSensorFusion();
                        RC3DK.stopSensors();
                        alert(status.error.class + ":" + status.error.code);
                    }
                }
            });

            var exFactor = 15; // translation exaggeration factor
            RC3DK.onDataUpdate(function (data)
            {
//                    if (data.transformation.rotation)
//                    {
//                        camera.quaternion.set(data.transformation.rotation.qy, data.transformation.rotation.qz, data.transformation.rotation.qx, data.transformation.rotation.qw);
//                    }

                if (data.transformation.translation)
                {
                    camera.position.set(-data.cameraTransformation.translation.v1 * exFactor, data.cameraTransformation.translation.v2 * exFactor, -data.cameraTransformation.translation.v0 * exFactor);
                }

                renderer.render( scene, camera );
            });

        </script>
        <form>
        <input type="button" id="shutterButton" value="Shutter" height="40"/><span id="message">Hello</span>
        </form>
    </body>
</html>